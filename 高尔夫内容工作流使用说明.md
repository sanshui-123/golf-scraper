# 🏌️ 高尔夫内容工作流使用说明

## 📋 功能概述

这个工作流自动完成以下任务：
1. **时间过滤**：抓取北京时间昨日10点到今日10点的文章
2. **内容抓取**：获取Golf Monthly网站的文章内容
3. **图片下载**：下载文章中的所有图片（无数量限制）
4. **智能改写**：使用Claude按照专业提示词改写内容
5. **格式输出**：生成适合微信公众号的HTML格式
6. **数据记录**：同步到飞书表格进行管理

## 🚀 快速开始

### 1. 最简单的运行方式
```bash
./run_daily_golf.sh
```

### 2. 直接运行Node.js
```bash
node golf_daily_complete.js
```

## 📁 输出文件说明

运行完成后，会在 `golf_content/[日期]/` 目录下生成：

```
golf_content/
└── 2025-07-08/                  # 今日日期
    ├── images/                   # 所有图片
    │   ├── article_1_img_1.jpg
    │   ├── article_1_img_2.jpg
    │   └── ...
    ├── wechat_ready/            # 微信公众号格式
    │   ├── wechat_2025-07-08_xxx.html
    │   └── ...
    ├── daily_report.json        # 日报统计
    └── README.md                # 使用指南
```

## 📱 发布到微信公众号

1. **打开文件夹**
   ```bash
   open golf_content/$(date +%Y-%m-%d)/wechat_ready/
   ```

2. **在浏览器中打开HTML文件**
   - 双击任意 `wechat_*.html` 文件

3. **复制内容**
   - 点击页面右上角的"复制文章内容"按钮
   - 或手动选择文章内容复制

4. **粘贴到公众号**
   - 打开微信公众号编辑器
   - 直接粘贴即可（格式和图片都会保留）

## 🖼️ 图片处理特点

- **无数量限制**：突破了原来5张的限制
- **自动下载**：所有图片自动下载到本地
- **智能嵌入**：图片自动嵌入到正确位置
- **格式保留**：改写时保留所有图片占位符

## 📊 飞书表格

如果配置了飞书，文章会自动同步到：
https://r94w8ejtw4.feishu.cn/base/At6ab0MBKaA8oWskhXmcDRVXnib?table=tbloNWVba5HkZsvR

表格包含：
- 文章标题
- 原文链接
- 改写内容
- 发布时间
- 图片数量

## ⚙️ 配置要求

### 1. Claude CLI（改写功能）
```bash
# 检查是否安装
claude --version

# 如未安装，请参考官方文档
```

### 2. 飞书配置（可选）
创建 `feishu_config.json` 文件：
```json
{
  "appId": "你的App ID",
  "appSecret": "你的App Secret",
  "baseId": "你的多维表格ID",
  "tableId": "你的数据表ID"
}
```

## 🔧 常见问题

### Q: Claude改写失败怎么办？
A: 程序会自动使用原文，不影响抓取功能

### Q: 图片下载失败？
A: 检查网络连接，程序会跳过失败的图片继续处理

### Q: 如何修改时间范围？
A: 目前固定为北京时间昨日10点到今日10点，如需修改请联系开发者

### Q: 能抓取其他网站吗？
A: 目前只支持Golf Monthly，可以扩展支持其他网站

## 📈 查看统计

查看当日处理结果：
```bash
cat golf_content/$(date +%Y-%m-%d)/daily_report.json | python -m json.tool
```

## 💡 使用建议

1. **定时运行**：建议每天上午10点后运行一次
2. **检查结果**：运行后检查生成的HTML预览
3. **及时发布**：改写完成后尽快发布到公众号
4. **备份数据**：定期备份 `golf_content` 目录

## 🛠️ 高级功能

### 单独运行组件
```bash
# 只抓取不改写
node golf_content_daily_unlimited.js

# 测试单篇文章
node test_v4_unlimited.js https://具体文章URL
```

### 查看历史记录
```bash
# 查看所有日期
ls golf_content/

# 查看特定日期
ls golf_content/2025-07-08/
```

## 📞 技术支持

如遇到问题，请检查：
1. 错误日志
2. 网络连接
3. 配置文件

---
*最后更新：2025-07-08*